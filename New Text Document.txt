#include <LiquidCrystal.h>

LiquidCrystal lcd (8 , 9 , 4 , 5 , 6 , 7);
int kon = 0;

int br_reci = 0;
char karakter[2];
int duzina;
int broj_zivota = 10;
int kon1 = 0;
int br_pogodjenih = 0;
int zavrseno = 0;

String reci[6] = {"jedan", "dva", "tri", "pet", "sedam", "osam"};

char slova[26] = {'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'y', 'v', 'w', 'x', 'y', 'z'};
char uneta[5] = {' ', ' ', ' ', ' ', ' '};
int k = 0;
int kon2 = 0;

String ocitajTaster(){
  String x;
  int ulaz = analogRead(0);
  if(ulaz < 75) x = "RIGHT";
  else if(ulaz < 200) x = "UP";
  else if(ulaz < 400) x = "DOWN";
  else if(ulaz < 600) x = "LEFT";
  else if(ulaz < 1000) x = "SELECT";
  else x = "NISTA";
  return x;
}

void setup() {
  // put your setup code here, to run once:
  Serial.begin(9600);
  lcd.begin(16 ,2);
  randomSeed(analogRead(1));
  br_reci = random(0, 6);
  for(int i = 0; i < reci[br_reci].length(); i++){
    lcd.print("_");
  }
  Serial.print("Rec: ");
  Serial.print(reci[br_reci]);
  lcd.setCursor(0, 1);
  lcd.print(broj_zivota);
  lcd.setCursor(15, 1);
  lcd.print(slova[0]);
}

void loop() {
  // put your main code here, to run repeatedly:
  kon1 = 0;
  
  /*while(!Serial.available());
  delay(20);
  duzina = Serial.available();
  Serial.readBytes(karakter, duzina);
  karakter[duzina] = 0;
  Serial.print("Unet karakter: ");
  Serial.println(karakter);*/


  if(ocitajTaster() == "SELECT" && kon == 0) { 
    kon = 1;
    if(zavrseno == 1){
      zavrseno = 0;
      broj_zivota = 10;
      randomSeed(analogRead(1));
      br_reci = random(0, 6);
      lcd.clear();
      lcd.setCursor(0, 0);
      for(int i = 0; i < reci[br_reci].length(); i++){
        lcd.print("_");
      }
      Serial.println("Rec: ");
      Serial.print(reci[br_reci]);
      lcd.setCursor(0, 1);
      lcd.print(broj_zivota);
      lcd.setCursor(15, 1);
      lcd.print(slova[0]);
      karakter[0] = 0;
    }else{
      karakter[0] = slova[k]; 
    }
  }else if(ocitajTaster() == "UP" && kon == 0) { 
    k++;
    if(k == 26) k = 0;
    lcd.setCursor(15, 1);
    lcd.print(slova[k]);
    kon = 1;
  }else if(ocitajTaster() == "DOWN" && kon == 0) { 
    k--;
    if(k == -1) k = 26;
    lcd.setCursor(15, 1);
    lcd.print(slova[k]);
    kon = 1;
  }else if(ocitajTaster() == "NISTA") {
    kon = 0;
  }
  
  if(karakter[0] != 0){
    for(int i = 0; i < reci[br_reci].length(); i++){
      if(reci[br_reci][i] == karakter[0]){
        for(int i = 0; i< br_pogodjenih; i++){
          if (karakter[0] == uneta[i]) kon2 = 1;
        }
        if(kon2 == 0)
         {lcd.setCursor(i, 0);
           lcd.print(karakter[0]);
           br_pogodjenih++;
           uneta[br_pogodjenih-1] = karakter[0];
           kon1 = 1;
         }
         kon2 = 0;
      }    
    }
    if(kon1 == 1){
      if(br_pogodjenih == reci[br_reci].length()){
        lcd.setCursor(0, 1);
        lcd.print("preziveo :)");
        zavrseno = 1;
      }
    }else if(kon1 == 0){
      broj_zivota--;
      lcd.setCursor(0, 1);
      lcd.print("  ");
      lcd.setCursor(0, 1);
      if(broj_zivota == 0){
        lcd.print("obesen :(");
      }else{
        lcd.print(broj_zivota); 
      }
    }
  }

  karakter[0] = 0;

}